include layouts/header

.container(style={'margin-top':'80px', 'margin-bottom': '70px'})
	.col-sm-12
		button.btn.btn-primary.btn-sm#addNewInstitution(type='button' name='addNewInstitution') Add New
	.col-sm-12(style={'margin-top':'10px'})
		table#allInstitutionsTable.row-border.hover.order-column
			thead
				tr
					th Institution
					th City
					th Province
					th Postal Code
					th Country
					th
				tbody



script(type='text/javascript').
	$(document).ready(function() {

			   formSecurity('Institution');

			   var table = $('#allInstitutionsTable').DataTable( {
							"lengthMenu": [[25, 50, -1], [25, 50, "All"]],
							"bPaginate": true,
							"bLengthChange": true,
							"ajax": {
										"type"   : "GET",
										"url"    : '/notFilteredInstitutions',
										"dataSrc": ""
									  },
							"columns": [ 
								{"data": "InstitutionName","width": "45%"},
								{"data": "City","width": "10%"},
								{"data": "Province","width": "5%"},
								{"data": "PostalCode","width": "10%"},
								{"data": "Country","width": "10%"},
								 {"targets": -1,"width": "5%",
								 "data": null,
								"defaultContent": "<a style='margin-left:1em;' id='edit' class='fa fa-pencil' href=''></a>"   } 
								]									  
					});

						$('#addNewInstitution').click(function(e){   window.location.href = '/institutions/add';  });
					
					$('#allInstitutionsTable tbody').on( 'click', '#edit', function () {
						var data = table.row( $(this).parents('tr') ).data();
						window.location.href = '/institutions/edit/' + data['InstitutionID'];
						return false;
					} );

					$('#allInstitutionsTable tbody').on( 'click', '#remove', function () {
						var x = confirm('Are you sure you want to delete this institution?'); 
						if (x == true ) {	
							var data = table.row( $(this).parents('tr') ).data();
							window.location.href = '/institutions/delete/' + data['InstitutionID'];
						}
						return false;
					} );
					
													

					$('#allInstitutionsTable tbody').on( 'click', 'tr', function () {
							if ( $(this).hasClass('selected') ) {
								$(this).removeClass('selected');
							}
							else {
								table.$('tr.selected').removeClass('selected');
								$(this).addClass('selected');
							}
						} );


				});


